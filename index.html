<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Top Reviewa</title>
  <link rel="icon" type="image/jpeg" href="https://i.ibb.co/1GrhnMc4/images.jpg" />
  <link rel="stylesheet" href="./styles.css" />
  <style>
    :root { --brand: #0099cc; }
    body {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .launch {
      width: 100%;
      max-width: 720px;
    }
    .launchCard {
      background: white;
      box-shadow: 0 8px 30px rgba(0,0,0,.08);
      border-radius: 16px;
      overflow: hidden;
    }
    .launchHeader {
      background: var(--brand);
      padding: 32px 36px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .launchHeader .brand {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .launchHeader .logo {
      height: 48px;
      border-radius: 8px;
      background: var(--brand);
      padding: 4px;
    }
    .launchHeader .title {
      color: white;
      font-size: 22px;
      font-weight: 800;
    }
    .launchHeader .subtitle {
      color: rgba(255,255,255,.75);
      font-size: 13px;
      margin-top: 2px;
    }
    .launchHeader .badge {
      background: rgba(255,255,255,.15);
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 12px;
      backdrop-filter: blur(4px);
    }
    .launchBody {
      padding: 32px;
    }
    .launchGrid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .bigLink {
      padding: 24px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: #fafbfc;
      display: flex;
      flex-direction: column;
      gap: 10px;
      transition: all 0.2s ease;
      text-decoration: none;
    }
    .bigLink:hover {
      border-color: var(--brand);
      background: #f0f9ff;
      box-shadow: 0 4px 16px rgba(0,0,0,.06);
      transform: translateY(-2px);
    }
    .bigLinkIcon {
      width: 44px;
      height: 44px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      margin-bottom: 4px;
    }
    .bigLinkTitle {
      font-weight: 700;
      font-size: 17px;
      color: #1e293b;
    }
    .bigLinkDesc {
      color: #64748b;
      font-size: 13px;
      line-height: 1.5;
    }
    .bigLinkArrow {
      margin-top: 8px;
      color: var(--brand);
      font-weight: 600;
      font-size: 13px;
    }
    .launchStats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e2e8f0;
    }
    .launchStat {
      text-align: center;
    }
    .launchStatValue {
      font-size: 22px;
      font-weight: 800;
      color: #1e293b;
    }
    .launchStatLabel {
      font-size: 11px;
      color: #94a3b8;
      margin-top: 2px;
    }
    @media (max-width: 600px) {
      .launchGrid { grid-template-columns: 1fr; }
      .launchStats { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="launch">
    <div class="launchCard">
      <div class="launchHeader" id="launchHeader">
        <div class="brand">
          <img class="logo" id="launchLogo" src="https://i.ibb.co/1GrhnMc4/images.jpg" alt="Logo" />
          <div class="titleBlock">
            <div class="title" id="launchTitle">Top Reviewa</div>
            <div class="subtitle" id="launchSubtitle">Axxess Team Portal</div>
          </div>
        </div>
        <div class="badge">Live</div>
      </div>

      <div class="launchBody">
        <div class="launchGrid">
          <a class="bigLink" href="./tv.html" target="_blank">
            <div class="bigLinkIcon" style="background:rgba(59,130,246,.1); color:#3b82f6;">&#9733;</div>
            <div class="bigLinkTitle">TV Dashboard</div>
            <div class="bigLinkDesc">Full-screen display for the office showing weekly top performers, customer highlights, and monthly leaders.</div>
            <div class="bigLinkArrow">Open Dashboard &rarr;</div>
          </a>
          <a class="bigLink" href="./admin.html">
            <div class="bigLinkIcon" style="background:rgba(16,185,129,.1); color:#10b981;">&#9881;</div>
            <div class="bigLinkTitle">Manager Portal</div>
            <div class="bigLinkDesc">Review and approve feedback, manage agents and teams, import agents, configure settings, and export reports.</div>
            <div class="bigLinkArrow">Open Portal &rarr;</div>
          </a>
        </div>

        <div class="launchStats" id="launchStats">
          <div class="launchStat"><div class="launchStatValue" id="lsTotal">-</div><div class="launchStatLabel">Total Reviews</div></div>
          <div class="launchStat"><div class="launchStatValue" id="lsApproved">-</div><div class="launchStatLabel">Approved</div></div>
          <div class="launchStat"><div class="launchStatValue" id="lsAgents">-</div><div class="launchStatLabel">Agents</div></div>
          <div class="launchStat"><div class="launchStatValue" id="lsTeams">-</div><div class="launchStatLabel">Teams</div></div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="./supabase-client.js"></script>
  <script src="./app.js"></script>
  <script>
  (function() {
    var TV_CONFIG_KEY = "axxess_tv_config";
    var cfg;
    try { cfg = JSON.parse(localStorage.getItem(TV_CONFIG_KEY)) || {}; } catch(e) { cfg = {}; }

    // Migrate old title
    if (cfg.tvTitle === "Customer Recognition") cfg.tvTitle = "Top Reviewa";

    function applyCfg(c) {
      if (c.brandColor) {
        document.documentElement.style.setProperty("--brand", c.brandColor);
        document.getElementById("launchHeader").style.background = c.brandColor;
      }
      if (c.logoUrl) document.getElementById("launchLogo").src = c.logoUrl;
      if (c.companyName) {
        document.title = "Top Reviewa - " + c.companyName;
        document.getElementById("launchSubtitle").textContent = c.companyName + " Team Portal";
      }
      if (c.tvTitle) document.getElementById("launchTitle").textContent = c.tvTitle;
    }
    applyCfg(cfg);

    initState().then(function(state) {
      document.getElementById("lsTotal").textContent = state.items.length;
      document.getElementById("lsApproved").textContent = state.items.filter(function(i) { return i.status === "Approved"; }).length;
      document.getElementById("lsAgents").textContent = state.agents.length;
      document.getElementById("lsTeams").textContent = state.teams.length;

      // Load TV config from Supabase
      if (typeof dbLoadTvConfig === "function") {
        dbLoadTvConfig().then(function(dbCfg) {
          if (dbCfg) applyCfg(dbCfg);
        });
      }
    });
  })();
  </script>
</body>
</html>
